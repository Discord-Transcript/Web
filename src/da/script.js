(()=>{var U=Object.create,f=Object.defineProperty,P=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty,B=Object.getOwnPropertyNames,_=Object.getOwnPropertyDescriptor,G=t=>f(t,"__esModule",{value:!0}),V=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports),Y=(t,e,s)=>{if(G(t),e&&typeof e=="object"||typeof e=="function")for(let n of B(e))!F.call(t,n)&&n!=="default"&&f(t,n,{get:()=>e[n],enumerable:!(s=_(e,n))||s.enumerable});return t},j=t=>t&&t.__esModule?t:Y(f(t!=null?U(P(t)):{},"default",{value:t,enumerable:!0}),t),x=V((he,b)=>{b.exports=(t,e,s,n)=>{if(t!==s||e!==n){let i=t>s?s/t:1;t=Math.max(Math.round(t*i),0),e=Math.max(Math.round(e*i),0);let o=e>n?n/e:1;t=Math.max(Math.round(t*o),0),e=Math.max(Math.round(e*o),0)}return{width:t,height:e}}}),y=class extends HTMLElement{constructor(){super();this.toggle=this.toggle.bind(this)}connectedCallback(){this.addEventListener("click",this.toggle)}toggle(){document.body.classList.contains("theme-dark")?(document.body.classList.remove("theme-dark"),document.body.classList.add("theme-light")):(document.body.classList.remove("theme-light"),document.body.classList.add("theme-dark"))}};customElements.define("theme-switch",y);function J(t,e,s){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>customElements.define(t,e,s)):customElements.define(t,e,s)}var r=J;function z(t,e={},s=null){if(e||(e={}),typeof t=="string"){let n=document.createElement(t);for(let i in e)if(i==="bindEvents")for(let o of Object.keys(e.bindEvents))n.addEventListener(o,e.bindEvents[o]);else n.setAttribute(i,e[i]);if(Array.isArray(s))for(let i of s)i instanceof Node?n.appendChild(i):typeof i=="string"&&n.appendChild(document.createTextNode(i));else s instanceof Node?n.appendChild(s):typeof s=="string"&&n.appendChild(document.createTextNode(s));return n}throw new Error("Failed to create component. You may only pass a string or a Component.")}var a=z;function W(t,e,s="top"){let n=a("div",{class:`tooltip ${s}`},e),i=null;t.addEventListener("mouseenter",()=>{i=setTimeout(()=>{i=null,document.body.appendChild(n);let o=n.getBoundingClientRect(),c=t.getBoundingClientRect();s==="top"?(n.style.left=`${c.x+c.width/2-o.width/2}px`,n.style.top=`${c.y-o.height-5}px`):s==="right"&&(n.style.left=`${c.x+c.width+10}px`,n.style.top=`${c.y+c.height/2-o.height/2}px`),n.classList.add("entering"),setTimeout(()=>n.classList.remove("entering"),150)},1e3)}),t.addEventListener("mouseleave",()=>{n.classList.add("leaving"),setTimeout(()=>{n.remove(),n.classList.remove("leaving")},150),i&&clearTimeout(i)})}var u=W;var h=class extends HTMLElement{connectedCallback(){let e=new Date(parseInt(this.dataset.timestamp));this.dataset.type!=="full"&&u(this,new Intl.DateTimeFormat("en-GB",{year:"numeric",weekday:"long",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(e),this.dataset.type==="time"?"right":"top"),this.dataset.type==="date"?this.innerText=h.formatDate(e):this.dataset.type==="time"?this.innerText=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`:this.dataset.type==="full"?this.innerText=new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(e):console.warn(`MessageDate: Cannot parse date: unknown format ${this.dataset.type}`)}static formatDate(e){let s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date,i=(n.getUTCFullYear()-e.getUTCFullYear())*365+(n.getUTCMonth()-e.getUTCMonth())*30+(n.getUTCDate()-e.getUTCDate()),o=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0");return i===0?`Today at ${o}:${c}`:i===1?`Yesterday at ${o}:${c}`:i<7?`Last ${s[e.getDay()]} at ${o}:${c}`:`${e.getDate().toString().padStart(2,"0")}/${e.getMonth().toString().padStart(2,"0")}/${e.getFullYear().toString()}`}};r("message-date",h);var E=h;function Q(t,e){let s=K(e);s.addEventListener("click",n=>n.stopPropagation()),t.addEventListener("click",()=>{document.body.appendChild(s);let n=t.getBoundingClientRect(),i=s.getBoundingClientRect();s.style.left=`${n.x+n.width+10}px`,s.style.top=`${Math.min(n.y,window.innerHeight-i.height-15)}px`,s.classList.add("mounted"),setTimeout(()=>{let o=()=>{s.remove(),s.classList.remove("mounted"),window.removeEventListener("click",o)};window.addEventListener("click",o)},0)})}function K(t){let e=new Date(Number((BigInt(t.id)>>BigInt(22))+BigInt(14200704e5)));return a("div",{class:"user-popout"},[a("div",{class:"header"},[a("img",{src:t.avatar,alt:"avatar"}),a("div",{class:"details"},[a("div",{class:"username"},t.username),a("div",{class:"discriminator"},["#",t.discriminator]),a("div",{class:"badge"},t.badge)])]),a("div",{class:"body"},[a("div",{class:"field"},[a("div",{class:"title"},"Account Creation Date"),a("div",{class:"value"},E.formatDate(e))]),a("div",{class:"field"},[a("div",{class:"title"},"Messages Count"),a("div",{class:"value"},document.querySelectorAll(`discord-message[data-author="${t.id}"]`).length.toString())])])])}var m=Q;var L=j(x());function Z(t){let e=new URL(t.src),s=X(parseInt(t.dataset.width),parseInt(t.dataset.height));e.searchParams.set("width",s.width),e.searchParams.set("height",s.height),document.body.appendChild(a("div",{class:"modal-container entering",bindEvents:{click:()=>{let n=document.querySelector(".modal-container");n.classList.add("leaving"),setTimeout(()=>n.remove(),150)}}},a("div",{class:"modal-inner image",bindEvents:{click:n=>n.stopPropagation()}},[t.classList.contains("video")?a("video",{src:t.src,autoplay:!0,muted:!0,loop:!0,style:`width: ${s.width}px; height: ${s.height}px;`}):a("img",{src:e.href,alt:"Preview",style:`width: ${s.width}px; height: ${s.height}px;`}),a("a",{href:t.dataset.url,target:"_blank"},"Open original")]))),setTimeout(()=>document.querySelector(".modal-container").classList.remove("entering"),350)}function X(t,e){let s=Math.min(Math.round(.65*window.innerWidth),2e3),n=Math.min(Math.round(.65*window.innerHeight),2e3);return L.default(t,e,s,n)}var g=Z;function ee(t,e){if(!t)return;let s=a("div",{class:"context-menu"},e.map(n=>a("div",{class:"item",bindEvents:{click:()=>{s.remove(),n.callback()}}},n.name)));t.addEventListener("contextmenu",n=>{n.preventDefault(),n.stopPropagation();let i=document.querySelector(".context-menu");i&&i.remove(),document.body.appendChild(s);let o=s.getBoundingClientRect();s.style.left=`${n.x}px`,s.style.top=`${Math.min(n.y,window.innerHeight-o.height-15)}px`,setTimeout(()=>{let c=()=>{s.remove(),window.removeEventListener("click",c)};window.addEventListener("click",c)},0)})}var d=ee;function te(t){let e=document.createElement("textarea");e.value=t,e.style.opacity="0",e.style.position="absolute",e.style.pointerEvents="none",document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()}var l=te;var se=["January","February","March","April","May","June","July","August","September","October","November","December"],k=class extends HTMLElement{connectedCallback(){let e=-1;this.querySelectorAll("discord-message").forEach(s=>{let n=parseInt(s.querySelector("message-date").dataset.timestamp);if(e>0&&Math.floor((n-e)/1e3/60/60/24)>0){s.classList.contains("group-start")||s.classList.add("group-start");let i=new Date(n);this.insertBefore(a("div",{class:"divider"},`${i.getDate().toString().padStart(2,"0")} ${se[i.getMonth()]} ${i.getFullYear()}`),s)}e=n})}};r("discord-messages",k);var C=class extends HTMLElement{connectedCallback(){d(this,[{name:"Copy Message ID",callback:()=>l(this.dataset.id)}]),d(this.querySelector(".avatar"),[{name:"Copy Avatar URL",callback:()=>l(this.querySelector(".avatar").src)},{name:"Copy User ID",callback:()=>l(this.dataset.author)}]),d(this.querySelector("message-header .name"),[{name:"Copy User ID",callback:()=>l(this.dataset.author)}])}};r("discord-message",C);var M=class extends HTMLElement{connectedCallback(){let e=this.parentElement.previousElementSibling.previousElementSibling;m(this.querySelector(".name"),{id:this.parentElement.parentElement.dataset.author,username:this.querySelector(".name").textContent,discriminator:e.dataset.discriminator,avatar:e.src,badge:this.querySelector(".badge").textContent})}};r("message-header",M);var S=class extends HTMLImageElement{constructor(){super();this.onError=this.onError.bind(this)}connectedCallback(){this.addEventListener("error",this.onError);let e=this.nextElementSibling.nextElementSibling;m(this,{id:this.parentElement.dataset.author,username:e.querySelector(".name").textContent,discriminator:this.dataset.discriminator,avatar:this.src,badge:e.querySelector(".badge").textContent})}onError(){this.removeEventListener("error",this.onError);let e=parseInt(this.dataset.discriminator)||0;this.src=`https://cdn.discordapp.com/embed/avatars/${e%4}.png`}};r("message-avatar",S,{extends:"img"});var w=class extends HTMLElement{connectedCallback(){let e=[...this.childNodes].filter(s=>!(s instanceof HTMLBRElement));e.length<28&&!e.find(s=>!s.classList||!s.classList.contains("emoji"))&&e.forEach(s=>s.classList.add("jumbo"))}};r("message-markup",w);var T=class extends HTMLImageElement{constructor(){super();this.onError=this.onError.bind(this)}connectedCallback(){this.addEventListener("error",this.onError),u(this,this.alt)}onError(){this.parentNode.replaceChild(document.createTextNode(this.alt),this)}};r("message-emoji",T,{extends:"img"});var D=class extends HTMLElement{connectedCallback(){d(this,[{name:`Copy ${this.dataset.type[0].toUpperCase()+this.dataset.type.slice(1)} ID`,callback:()=>l(this.dataset.id)}]),this.dataset.type==="user"&&m(this,{id:this.dataset.id||"",username:this.dataset.username||"",discriminator:this.dataset.discriminator||"",avatar:this.dataset.avatar||"",badge:this.dataset.badge||""})}};customElements.define("message-mention",D);var $=class extends HTMLSpanElement{constructor(){super();this.onClick=this.onClick.bind(this)}connectedCallback(){this.addEventListener("click",this.onClick)}onClick(){this.classList.add("revealed"),this.removeEventListener("click",this.onClick)}};customElements.define("message-spoiler",$,{extends:"span"});var I=class extends HTMLPreElement{constructor(){super();this.onClick=this.onClick.bind(this),this.animation=!1}connectedCallback(){this.copyElement=this.querySelector(".copy"),this.copyElement.addEventListener("click",this.onClick)}onClick(){if(this.animation)return;this.animation=!0,this.copyElement.classList.add("success"),this.copyElement.innerText="Copied!",l(this.querySelector("code").textContent),setTimeout(()=>{this.copyElement.classList.remove("success"),this.copyElement.innerText="Copy"},3e3)}};r("message-codeblock",I,{extends:"pre"});var H=class extends HTMLImageElement{constructor(){super();this.onClick=()=>g(this),this.onError=this.onError.bind(this)}connectedCallback(){this.addEventListener("error",this.onError),this.dataset.clickable!==void 0&&this.addEventListener("click",this.onClick)}onError(){this.removeEventListener("error",this.onError),this.removeEventListener("click",this.onClick),this.removeAttribute("data-clickable"),this.src="https://discord.com/assets/e0c782560fd96acd7f01fda1f8c6ff24.svg"}},q=class extends HTMLVideoElement{constructor(){super();this.onClick=()=>g(this)}connectedCallback(){this.addEventListener("click",this.onClick)}};customElements.define("message-image",H,{extends:"img"});customElements.define("message-gifv",q,{extends:"video"});var R=class extends HTMLDivElement{constructor(){super();this.onClick=this.onClick.bind(this)}connectedCallback(){this.querySelector(".play").addEventListener("click",this.onClick)}onClick(){this.innerHTML="";let e=document.createElement("iframe");e.width=parseInt(this.style.width).toString(),e.height=parseInt(this.style.height).toString(),e.frameBorder="0",e.allowFullscreen=!0;let s=new URL(this.dataset.url);s.searchParams.append("autoplay","1"),s.searchParams.append("auto_play","1"),e.src=s.href,this.appendChild(e)}};r("message-video",R,{extends:"div"});var A=class extends HTMLElement{constructor(){super();this.onClick=this.onClick.bind(this)}connectedCallback(){let e=this.querySelector(".preview");e&&e.addEventListener("click",this.onClick)}async onClick(){this.renderModal("LOADING");let e=this.querySelector("a").href,s=await fetch(e.replace("https://cdn.discordapp.com",window.GLOBAL_ENV.HOSTNAME));if(!s.ok)return this.renderModal("ERRORED");this.renderModal("FETCHED",await s.text())}renderModal(e,s){let n=this.querySelector("a").textContent,i=document.querySelector(".modal-container");if(!i){let v=()=>{let p=document.querySelector(".modal-container");p.classList.add("leaving"),setTimeout(()=>p.remove(),150)};i=a("div",{class:"modal-container entering",bindEvents:{click:v}},a("div",{class:"modal-inner",bindEvents:{click:p=>p.stopPropagation()}},a("div",{class:"modal"},[a("div",{class:"modal-header"},"Attachment"),a("div",{class:"modal-body"},[a("div",null,[a("b",null,"Filename:"),` ${n}`]),a("div",null,[a("b",null,"File size:"),` ${this.querySelector("span").textContent}`]),a("div",{class:"attachment-details"})]),a("div",{class:"modal-footer"},[a("button",{bindEvents:{click:v}},"Got it"),a("a",{href:this.querySelector("a").href,target:"_blank"},"Download")])]))),document.body.appendChild(i)}let o=null;switch(e){case"LOADING":o=a("div",{class:"spinner"});break;case"FETCHED":o=a("div",{class:"contents"},[a("div",{class:"lang"},n.split(".").pop()),a("div",{class:"shitcode"},[a("div",{class:"lines"}),a("code",null,s)]),a("div",{class:"copy"},"Copy")]);break;case"ERRORED":o=a("div",{class:"error"},"Failed to load attachment contents.");break}let c=i.querySelector(".attachment-details");c.innerHTML="",c.appendChild(o)}};r("message-attachment",A);var O=class extends HTMLElement{async connectedCallback(){this.render("RESOLVING");let e=await this.fetchInvite();if(e)return this.render("RESOLVED",e);this.render("INVALID")}render(e,s){this.innerHTML="";let n=[];switch(e){case"RESOLVING":n=[a("div",{class:"header"},"Resolving Invite"),a("div",{class:"resolving"})];break;case"INVALID":n=[a("div",{class:"header"},"You received an invite, but..."),a("div",{class:"guild"},[a("img",{src:"https://discord.com/assets/e0c782560fd96acd7f01fda1f8c6ff24.svg",alt:"poop"}),a("div",{class:"invalid"},"Invalid Invite")])];break;case"RESOLVED":n=[a("div",{class:"header"},"You've been invited to join a server"),a("div",{class:"guild"},[a("img",{src:`https://cdn.discordapp.com/icons/${s.guild.id}/${s.guild.icon}.${s.guild.icon.startsWith("a_")?"gif":"png"}`,alt:"Guild Icon"}),a("div",{class:"details"},[a("div",{class:"name"},s.guild.name),a("div",{class:"counts"},[a("div",{class:"online"}),a("span",{class:"count"},[a("b",null,s.approximate_presence_count.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),"Online"]),a("div",{class:"offline"}),a("span",{class:"count"},[a("b",null,s.approximate_member_count.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),"Members"])])]),a("a",{href:`https://discord.gg/${s.code}`,target:"_blank",class:"button"},"Join")])];break}n.forEach(i=>this.appendChild(i))}async fetchInvite(){let e=await fetch(`https://discord.com/api/v6/invite/${this.dataset.code}?with_counts=true`);if(e.ok)return e.json()}};customElements.define("discord-invite",O);window.addEventListener("contextmenu",t=>{t.preventDefault();let e=document.querySelector(".context-menu");e&&e.remove()});document.querySelectorAll("img[data-clickable], message-markup a, .embed a").forEach(t=>{d(t,[{name:"Copy Link",callback:()=>l(t.src||t.href)},{name:"Open Link",callback:()=>open(t.src||t.href)}])});function N(){navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&document.body.classList.add("firefox"),navigator.userAgent.toLowerCase().indexOf("chrome")!==-1&&document.body.classList.add("chrome")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",N):N();})();
